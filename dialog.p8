pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
cfg = {
	mar = 2,
	txt_on_c = 10,
	txt_off_c = 6,
	bg = 3
}

delta=0
last_t=0

anim = {
	create = function(n, x, y, f_x)
		printh(x)
		return {
			start_n = n,
			n = n,
			x = x,
			y = y,
			f_x = f_x,
			dt = 0,
			fin = true
		}
	end,
	start = function(self)
		self.fin = false
	end,
	update = function(self)
		if (self.fin) then return end
		self.dt += delta
		if (self.dt > 0.5) then
			self.dt = 0;
			self.n += 2; --sprite 16px
			if (self.n == self.start_n + 4) then
				self.n = self.start_n
			end
		end
	end,
	draw = function(self)
		spr(self.n, self.x, self.y, 2, 2)
	end
}

text={
	create = function()
		return {
			t = "",
			t_pos = 0,
			delta = 0,
			fin = true,
		}
	end,
	start = function(self)
		sfx(0)
	end,
	update = function(self)
		if (self.fin) then return end
		self.delta += delta
		if (self.delta > 0.05) then
			self.delta = 0
			self.t_pos += 2
			self.t = sub(mess_1,0,self.t_pos)
			if (self.t_pos > #mess_1) then
				self.fin = true
				sfx(0, -2)
				return
			end 
		end
	end,
	draw = function(self)
		local c1, c2 = cfg.txt_off_c, cfg.txt_on_c
		if mess_print == 1 then
			c1, c2 = c2, c1
		end
		print(self.t, 2 * cfg.mar + 16, cfg.mar, c1)
	end
}

-->8
-- dialog

mess_print = 1 -- 1 or 2.

mess_1=[[
let's start with something
simple.
]]

mess_2=[[
let's start with something
simple.
]]

-->8
-- declarations

text1 = text.create()
text2 = text.create()
anim1 = anim.create(0, cfg.mar, 63 + cfg.mar, false)
anim2 = anim.create(32, 128 - cfg.mar - 16, 63 + cfg.mar, true)

-->8
-- main
function _init()
	if (mess_print == 1) then
		anim.start(anim1)
	end
end

function _update()
	delta=time()-last_t
	last_t=time()
	text.update(text1)
	text.update(text2)
	anim.update(anim1)
	anim.update(anim2)
end

function _draw()
	cls(cfg.bg)
	rect(2 * cfg.mar + 16, cfg.mar, 127 - cfg.mar, 64 - cfg.mar, 2)
	rect(cfg.mar, 63 + cfg.mar, 127 - cfg.mar * 2 - 16, 128 - cfg.mar, 2)
	text.draw(text1)
	text.draw(text2)
	anim.draw(anim1)
	anim.draw(anim2)
end

__gfx__
80000000000000009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000011110000000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000115511000000000011551100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001155551100000000115555110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011515115100000001151511510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011151111100000001115111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001151a11a100000001151a11a10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001511111100000000151111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001511111100000000151111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011151111100000001115111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00015155115100000001515511510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00155115555110000015511555511000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00155115551110000015511555111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00151111551110000015111155111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00111111511110000011111151111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00010011110100000001001111010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80001110000000009000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00016771000000000001677100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00166777100000000016677710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00166171111000000016617110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00016777551100000001677711100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001671155110000000167155110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001d111111100000001d1115511000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001611a11a10000000161111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000015114664100000001511a11a1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000015116dd610000000151146641000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00014f15d66d110000014f116dd61100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00014f115661111000014f15d66d1110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001515111555100000151556655510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000151155514f100000151155514f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001511555111000000151155511100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001511555110000000151155511000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200042b3733131332313373732730317303153031b3031b3031a3030f3032a3032a3032a303293032930300303003030030300303003030030300303003030030300303003030030300303003030030300300
__music__
00 00024344

